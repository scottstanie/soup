---

title: shrinkwrap


keywords: fastai
sidebar: home_sidebar



nb_path: "00_core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_differentiation_matrices" class="doc_header"><code>make_differentiation_matrices</code><a href="https://github.com/fastai/shrinkwrap/tree/master/shrinkwrap/core.py#L11" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_differentiation_matrices</code>(<strong><code>rows</code></strong>, <strong><code>columns</code></strong>, <strong><code>boundary_conditions</code></strong>=<em><code>'neumann'</code></em>, <strong><code>dtype</code></strong>=<em><code>float32</code></em>)</p>
</blockquote>
<p>Generate derivative operators as sparse matrices.</p>
<p>Matrix-vector multiplication is the fastest way to compute derivatives
of large arrays, particularly for images. This function generates
the matrices for computing derivatives. If derivatives of the same
size array will be computed more than once, then it generally is
faster to compute these arrays once, and then reuse them.</p>
<p>The three supported boundary conditions are 'neumann' (boundary
derivative values are zero), 'periodic' (the image ends wrap around
to beginning), and 'dirichlet' (out-of-bounds elements are zero).
'neumann' seems to work best for solving the unwrapping problem.</p>
<p>Source:
<a href="https://github.com/rickchartrand/regularized_differentiation/blob/master/regularized_differentiation/differentiation.py">https://github.com/rickchartrand/regularized_differentiation/blob/master/regularized_differentiation/differentiation.py</a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_laplace_kernel" class="doc_header"><code>make_laplace_kernel</code><a href="https://github.com/fastai/shrinkwrap/tree/master/shrinkwrap/core.py#L64" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_laplace_kernel</code>(<strong><code>rows</code></strong>, <strong><code>columns</code></strong>)</p>
</blockquote>
<p>Generate eigenvalues of diagonalized Laplacian operator</p>
<p>Used for quickly solving the linear system ||D \Phi - phi|| = 0</p>
<p>References:
Numerical recipes, Section 20.4.1, Eq. 20.4.22 is the Neumann case
or <a href="https://elonen.iki.fi/code/misc-notes/neumann-cosine/">https://elonen.iki.fi/code/misc-notes/neumann-cosine/</a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span>
<span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">make_differentiation_matrices</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">boundary_conditions</span><span class="o">=</span><span class="s1">&#39;periodic&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">axr</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">axr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">dx</span><span class="o">.</span><span class="n">todense</span><span class="p">()),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">axr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Dx&quot;</span><span class="p">)</span>
<span class="n">axr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">((</span><span class="n">dy</span><span class="o">.</span><span class="n">todense</span><span class="p">()),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">axr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Dy&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5, 1.0, &#39;Dy&#39;)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

